{% extends "core/base.html" %}

{% block title %}Find Your Item - WMS{% endblock %}

{% block extra_head %}{% endblock %}

{% block content %}
    <div class="m3-page-shell m3-page-shell--primary">
        <section class="m3-search-stack">
            <form method="post" class="m3-form-vertical m3-form-vertical--floating" novalidate>
                {% csrf_token %}
                <div class="m3-field-group">
                    <div class="m3-filled-text-field">
                        {{ form.query }}
                        <button type="submit" class="m3-input-action" aria-label="Run search">
                            <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 1 0-.71.71l.27.28v.79l5 4.99L20.49 19zM9.5 14a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9z" />
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="m3-field-group">
                    <label for="bin_filter" class="m3-field-label">Browse by Bin</label>
                    <div class="m3-select-wrapper">
                        {% with selected=selected_bin_id|default_if_none:'' %}
                            <select id="bin_filter" name="bin_filter" class="m3-select">
                                <option value="" {% if not selected %}selected{% endif %}>Select a Bin</option>
                                {% if bins %}
                                    {% for bin in bins %}
                                        <option value="{{ bin.id }}" {% if selected == bin.id|stringformat:"s" %}selected{% endif %}>{{ bin.name }}</option>
                                    {% endfor %}
                                {% else %}
                                    <option value="" disabled>You haven't added any bins yet</option>
                                {% endif %}
                            </select>
                        {% endwith %}
                    </div>
                </div>
            </form>
        </section>

        {% if result %}
        <section aria-live="polite" aria-atomic="true">
            <div class="m3-list" role="list">
                {% with initial=result|default_if_none:''|striptags|slice:":1" %}
                    <article class="m3-card m3-card--tonal m3-search-results__card" role="listitem">
                        <div class="m3-search-results__avatar" aria-hidden="true">{{ initial|default:"R" }}</div>
                        <div class="m3-search-results__content">
                            {{ result|linebreaksbr }}
                        </div>
                    </article>
                {% endwith %}
            </div>
        </section>
        {% endif %}
    </div>
{% endblock %}

{% block extra_js %}
    <script>
        const searchInput = document.getElementById("id_query");
        if (searchInput) {
            searchInput.focus();
        }
    </script>
{% endblock %}