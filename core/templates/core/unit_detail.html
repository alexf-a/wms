{% extends "core/base.html" %}

{% block title %}{{ unit.name }} - WMS{% endblock %}

{% block content %}
<div class="m3-page-shell">
    <!-- Unit Header Card -->
    <div class="m3-card m3-card--filled">
        <div class="m3-card__content">
            <div class="m3-card__icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 4H20V20H4V4ZM6 6V18H18V6H6ZM8 8H16V10H8V8ZM8 12H16V14H8V12Z" fill="currentColor"/>
                </svg>
            </div>
            <h1 class="md-typescale-headline-medium m3-card__title">{{ unit.name }}</h1>
            <p class="md-typescale-body-medium m3-card__description">
                {{ unit.description }}
            </p>
        </div>
        <div class="m3-card__actions">
            <a href="{% url 'unit_qr' unit.user_id unit.access_token %}" class="m3-button m3-button-tonal">
                <svg class="m3-button-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M3 11h8V3H3v8zm2-6h4v4H5V5zm8-2v8h8V3h-8zm6 6h-4V5h4v4zM3 21h8v-8H3v8zm2-6h4v4H5v-4zm13 2h3v3h2v-3h3v-2h-3v-3h-2v3h-3v2z"/>
                </svg>
                <span class="m3-button-label">Download QR Code</span>
            </a>
            <a href="{% url 'add_items_to_unit' %}" class="m3-button m3-button-filled">
                <svg class="m3-button-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                </svg>
                <span class="m3-button-label">Add Items</span>
            </a>
        </div>
    </div>

    <!-- Items Section -->
    <h2 class="md-typescale-title-large" style="margin-top: var(--wms-space-xl); margin-bottom: var(--wms-space-md); color: var(--md-sys-color-on-surface);"> Your Items </h2>
    
    {% if unit.items.all %}
        <div class="m3-list">
            {% for item in unit.items.all %}
                <a href="{% url 'item_detail' item.id %}" class="m3-list-item" style="text-decoration: none; color: inherit;">
                    <div class="m3-list-item__leading{% if item.image %} m3-list-item__leading--has-image{% endif %}">
                        {% if item.image %}
                            <img src="{{ item.image.url }}" alt="{{ item.name }}" class="m3-thumbnail-img">
                        {% else %}
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"/>
                            </svg>
                        {% endif %}
                    </div>
                    <div class="m3-list-item__content">
                        <div class="md-typescale-body-large" style="font-weight: 500; color: var(--md-sys-color-on-surface);">
                            {{ item.name }}
                        </div>
                        {% if item.description %}
                            <div class="md-typescale-body-medium" style="color: var(--md-sys-color-on-surface-variant); margin-top: 4px;">
                                {{ item.description|truncatewords:15 }}
                            </div>
                        {% endif %}
                    </div>
                </a>
            {% endfor %}
                <div class="m3-button-centered">
                    <a href="{% url 'add_items_to_unit' %}" class="m3-button m3-button-filled m3-button-small" style="flex-direction: column; gap: 4px; padding: 16px 24px;">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                        </svg>
                        <span class="md-typescale-label-small">Add Item</span>
                    </a>
                </div>
        </div>
    {% else %}
        <div class="m3-card m3-card--filled" style="text-align: center; padding: var(--wms-space-xl);">
            <div class="m3-card__content">
                <div class="m3-card__icon" style="margin: 0 auto var(--wms-space-md);">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z" fill="currentColor"/>
                    </svg>
                </div>
                <p class="md-typescale-body-large" style="color: var(--md-sys-color-on-surface-variant); margin-bottom: var(--wms-space-md);">
                    This unit is empty
                </p>
                <div class="m3-button-centered">
                    <a href="{% url 'add_items_to_unit' %}" class="m3-button m3-button-filled m3-button-small" style="flex-direction: column; gap: 4px; padding: 16px 24px;">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                        </svg>
                        <span class="md-typescale-label-small">Add Item</span>
                    </a>
                </div>
            </div>
        </div>
    {% endif %}

    <!-- Back Button -->
    <div style="margin-top: var(--wms-space-xl);">
        <a href="{% url 'list_units' %}" class="m3-button m3-button-tonal m3-button-small">
            <svg class="m3-button-icon" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
            <span class="m3-button-label">Back</span>
        </a>
    </div>
</div>

<nav class="m3-bottom-nav">
    <a href="{% url 'home_view' %}" class="m3-nav-item">
        <div class="m3-nav-icon-container">
            <svg class="m3-nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
            </svg>
        </div>
        <span class="m3-nav-label">Home</span>
    </a>

    <a href="{% url 'list_units' %}" class="m3-nav-item m3-nav-item-active">
        <div class="m3-nav-icon-container">
            <svg class="m3-nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 2H4c-1 0-2 .9-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1.1-1-2-2-2zm-5 12H9v-2h6v2zm5-7H4V4h16v3z" />
            </svg>
        </div>
        <span class="m3-nav-label">Inventory</span>
    </a>

    <a href="{% url 'item_search' %}" class="m3-nav-item">
        <div class="m3-nav-icon-container">
            <svg class="m3-nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 1 0-.71.71l.27.28v.79l5 4.99L20.49 19zM9.5 14a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9z" />
            </svg>
        </div>
        <span class="m3-nav-label">Search</span>
    </a>
</nav>
{% endblock %}
